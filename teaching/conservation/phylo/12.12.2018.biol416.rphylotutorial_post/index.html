<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.55.6" />
    <meta name="description" content="">
<meta name="author" content="Mairin">

    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>BIOL 416 R Tutorial 2 - Phylogenies in R :: Mairin Deith</title>

    
    <link href="/css/nucleus.css?1558662433" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1558662433" rel="stylesheet">
    <link href="/css/hybrid.css?1558662433" rel="stylesheet">
    <link href="/css/featherlight.min.css?1558662433" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1558662433" rel="stylesheet">
    <link href="/css/auto-complete.css?1558662433" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1558662433" rel="stylesheet">
    <link href="/css/theme.css?1558662433" rel="stylesheet">
    <link href="/css/hugo-theme.css?1558662433" rel="stylesheet">
    
      <link href="/css/theme-mine.css?1558662433" rel="stylesheet">
    

    <script src="/js/jquery-3.3.1.min.js?1558662433"></script>

    <style type="text/css">
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/teaching/conservation/phylo/12.12.2018.biol416.rphylotutorial_post/">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="/">

	<img src="/images/logo_text_tall_svg.png" alt="Logo" height="90%" width="90%">

</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1558662433"></script>
<script type="text/javascript" src="/js/auto-complete.js?1558662433"></script>
<script type="text/javascript">
    
        var baseurl = "\/";
    
</script>
<script type="text/javascript" src="/js/search.js?1558662433"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/projects/" title="Research Projects" class="dd-item 
        
        
        
        ">
      <a href="/projects/">
          <b><i class='fas fa-terminal'> </i>      </b>Research Projects
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/projects/spatial_mapping/" title="Spatial Mapping of Bushmeat Hunting" class="dd-item 
        
        
        
        ">
      <a href="/projects/spatial_mapping/">
          <b><i class='fas fa-layer-group'> </i>   </b>Spatial Mapping of Bushmeat Hunting
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/projects/decision_making/" title="Bayesian Decision Analysis" class="dd-item 
        
        
        
        ">
      <a href="/projects/decision_making/">
          <b><i class='fas fa-project-diagram'> </i>   </b>Bayesian Decision Analysis
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/projects/simulations/" title="MSE for Sustainable Harvests" class="dd-item 
        
        
        
        ">
      <a href="/projects/simulations/">
          <b><i class='fas fa-tasks'> </i>   </b>MSE for Sustainable Harvests
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/projects/simulations/redfish/" title="Canadian Atlantic Redfish" class="dd-item 
        
        
        
        ">
      <a href="/projects/simulations/redfish/">
          Canadian Atlantic Redfish
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/projects/simulations/stonessheep/" title="Stone&#39;s Sheep" class="dd-item 
        
        
        
        ">
      <a href="/projects/simulations/stonessheep/">
          Stone&#39;s Sheep
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/projects/simulations/shiny_pva/" title="PVA&#43;Shiny for Invasive Species Eradication" class="dd-item 
        
        
        
        ">
      <a href="/projects/simulations/shiny_pva/">
          <b><i class='far fa-times-circle'> </i>   </b>PVA&#43;Shiny for Invasive Species Eradication
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/teaching/" title="Teaching" class="dd-item 
        parent
        
        
        ">
      <a href="/teaching/">
          <b><i class='fas fa-apple-alt'> </i>   </b>Teaching
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/teaching/code_for_all/" title="Coding for the Masses" class="dd-item 
        
        
        
        ">
      <a href="/teaching/code_for_all/">
          <b><i class='fab fa-python'> </i>   </b>Coding for the Masses
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/teaching/conservation/" title="Ecology &amp; Conservation" class="dd-item 
        parent
        
        
        ">
      <a href="/teaching/conservation/">
          <b><i class='fab fa-envira'> </i>   </b>Ecology &amp; Conservation
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/teaching/conservation/beftutorial/biol416_befanalysis_assignmentinstructions.nb/" title="" class="dd-item ">
        <a href="/teaching/conservation/beftutorial/biol416_befanalysis_assignmentinstructions.nb/">
        
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/teaching/conservation/beftutorial/biol416_befanalysis_assignmentinstructions/" title="BIOL 416 Assignment 1" class="dd-item ">
        <a href="/teaching/conservation/beftutorial/biol416_befanalysis_assignmentinstructions/">
        BIOL 416 Assignment 1
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/teaching/conservation/intror/biol416_introduction_to_r_notes/" title="BIOL 416 R Tutorial 1 - Introduction to R" class="dd-item ">
        <a href="/teaching/conservation/intror/biol416_introduction_to_r_notes/">
        BIOL 416 R Tutorial 1 - Introduction to R
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/teaching/conservation/intror/biol416_tutorial2_intror/" title="BIOL 416 R Tutorial 1 - Introduction to R" class="dd-item ">
        <a href="/teaching/conservation/intror/biol416_tutorial2_intror/">
        BIOL 416 R Tutorial 1 - Introduction to R
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/teaching/conservation/12.12.2018.biol416.rphylotutorial_post/" title="BIOL 416 R Tutorial 2 - Phylogenies in R" class="dd-item ">
        <a href="/teaching/conservation/12.12.2018.biol416.rphylotutorial_post/">
        BIOL 416 R Tutorial 2 - Phylogenies in R
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/teaching/conservation/phylo/12.12.2018.biol416.rphylotutorial/" title="BIOL 416 R Tutorial 2 - Phylogenies in R" class="dd-item ">
        <a href="/teaching/conservation/phylo/12.12.2018.biol416.rphylotutorial/">
        BIOL 416 R Tutorial 2 - Phylogenies in R
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/teaching/conservation/phylo/12.12.2018.biol416.rphylotutorial_post/" title="BIOL 416 R Tutorial 2 - Phylogenies in R" class="dd-item active">
        <a href="/teaching/conservation/phylo/12.12.2018.biol416.rphylotutorial_post/">
        BIOL 416 R Tutorial 2 - Phylogenies in R
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/teaching/conservation/phylo/biol416_tutorial3_phylogeneticsr/" title="BIOL 416 R Tutorial 2 - Phylogenies in R" class="dd-item ">
        <a href="/teaching/conservation/phylo/biol416_tutorial3_phylogeneticsr/">
        BIOL 416 R Tutorial 2 - Phylogenies in R
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/teaching/conservation/beftutorial/bef_lessonplan/" title="BIOL 416 R Tutorial 5 - Biodiversity-ecosystem function in plant communities" class="dd-item ">
        <a href="/teaching/conservation/beftutorial/bef_lessonplan/">
        BIOL 416 R Tutorial 5 - Biodiversity-ecosystem function in plant communities
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/teaching/conservation/beftutorial/biol416_tutorial5_bef_instructions/" title="BIOL 416 R Tutorial 5 - Biodiversity-ecosystem function in plant communities" class="dd-item ">
        <a href="/teaching/conservation/beftutorial/biol416_tutorial5_bef_instructions/">
        BIOL 416 R Tutorial 5 - Biodiversity-ecosystem function in plant communities
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/teaching/conservation/beftutorial/phylo/biol416_bef_phylogeneticslessonplan/" title="BIOL 416 R Tutorial 5 - Biodiversity-ecosystem function in plant communities" class="dd-item ">
        <a href="/teaching/conservation/beftutorial/phylo/biol416_bef_phylogeneticslessonplan/">
        BIOL 416 R Tutorial 5 - Biodiversity-ecosystem function in plant communities
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/teaching/conservation/beftutorial/phylo/biol416_tutorial6_befpd_instructions/" title="BIOL 416 R Tutorial 6 - Biodiversity-ecosystem function in plant communities pt. 2: Phylogenies" class="dd-item ">
        <a href="/teaching/conservation/beftutorial/phylo/biol416_tutorial6_befpd_instructions/">
        BIOL 416 R Tutorial 6 - Biodiversity-ecosystem function in plant communities pt. 2: Phylogenies
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/teaching/conservation/beftutorial/phylo/biol416_tutorial6_befpd_instructions_x/" title="BIOL 416 R Tutorial 6 - Biodiversity-ecosystem function in plant communities pt. 2: Phylogenies" class="dd-item ">
        <a href="/teaching/conservation/beftutorial/phylo/biol416_tutorial6_befpd_instructions_x/">
        BIOL 416 R Tutorial 6 - Biodiversity-ecosystem function in plant communities pt. 2: Phylogenies
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/teaching/conservation/beftutorial/phylo/13.02.2019_assignmentannouncement/" title="Common bugs" class="dd-item ">
        <a href="/teaching/conservation/beftutorial/phylo/13.02.2019_assignmentannouncement/">
        Common bugs
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/post/" title="Posts &amp; Tutorials" class="dd-item 
        
        
        
        ">
      <a href="/post/">
          <b><i class='far fa-newspaper'> </i>   </b>Posts &amp; Tutorials
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
             
            
          
            
            


 
  
    
      <li data-nav-id="/post/2015-07-23-r-rmarkdown/" title="Hello R Markdown" class="dd-item ">
        <a href="/post/2015-07-23-r-rmarkdown/">
        Hello R Markdown
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
             
            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/about/" title="About" class="dd-item 
        
        
        
        ">
      <a href="/about/">
          <b><i class='far fa-smile'> </i>   </b>About
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/about/_index0/" title="" class="dd-item ">
        <a href="/about/_index0/">
        
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li> 
                  <a class="padding" href="mailto:mairin.deith@gmail.com"><i class='fas fa-fw fa-envelope'></i> Email</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://github.com/mairindeith"><i class='fab fa-fw fa-github'></i> Github</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://twitter.com/sapiensimulator"><i class='fab fa-twitter'></i> Twitter</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      
      
      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> Clear History</a></li>
      
      </ul>
    </section>
    
    <section id="footer">
      <center>
    <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>
</center>

<script async defer src="https://buttons.github.io/buttons.js"></script>

    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            
            
          
          
            <a href='/'></a> > <a href='/teaching/'>Teaching</a> > <a href='/teaching/conservation/'>Ecology & Conservation</a> > BIOL 416 R Tutorial 2 - Phylogenies in R
          
         
          
         
          
         
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">

    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              BIOL 416 R Tutorial 2 - Phylogenies in R
            </h1>
          

        






<div id="tutorial-2" class="section level1">
<h1>Tutorial 2</h1>
<p>January 21 &amp; 23, 2019</p>
<div id="review-of-last-weeks-tutorial-introduction-to-r" class="section level2">
<h2>Review of last week’s tutorial (Introduction to R)</h2>
<ol style="list-style-type: decimal">
<li>Objects - 0, 1, and 2-D objects</li>
<li>Indexing objects - using <code>[]</code> and name-based <code>$</code> notation</li>
<li>Plotting</li>
<li>Linear regression and models</li>
</ol>
<pre class="r"><code>is.human &lt;- TRUE

is.human == TRUE
is.human == 10

read.csv(&quot;
         &quot;)

data(iris)
s.l &lt;- iris$Sepal.Length
s.l.deviation &lt;- iris$Sepal.Length/mean(iris$Sepal.Length)

plot(iris$Sepal.Length ~ iris$Sepal.Width)

lm(iris$Sepal.Length ~ iris$Sepal.Width)</code></pre>
</div>
<div id="introduction-to-phylogenies" class="section level2">
<h2>Introduction to phylogenies</h2>
<p>In this course, we’ll be working with phylogenetic trees and evolutionary relationships between species.
Evolution and the relatedness between species is increasingly used in conservation biology to identify the evolutionary consequences of extinction and identify whether closely related species share traits that make them more or less susceptible to extinction.</p>
<p><strong>Phylogenetic tree</strong> = a representation of species’ inter-relatedness; which species share ancestors and when their lineages diverged</p>
<p>Ultimately, we are interested in a few key pieces of information from the phylogeny:</p>
<ul>
<li><em>Node</em> : a point where a lineage splits into multiple descendant lineages (numbered 5-7 below)</li>
<li><em>Edge/branch</em> : lines that connect nodes in the tree, length represents evolutionary time</li>
<li><em>Tip</em> : terminal edges/branches that represent currently living lineages</li>
<li><em>Root</em> : nodes that are the root of all edges/branches</li>
</ul>
<p>Within the tree, we can represent the branching of lineages as a function of time or mutations.
<img src="/teaching/conservation/Phylo/12.12.2018.Biol416.RPhyloTutorial_post_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<ul>
<li><em>Strix aluco</em> = tawny owl</li>
<li><em>Asio otus</em> = long-eared owl</li>
<li><em>Athene nocturna</em> = little owl</li>
<li><em>Tyto alba</em> = barn owl</li>
</ul>
</div>
<div id="introduction-to-packages" class="section level2">
<h2>Introduction to packages</h2>
<p>We are now going to dive in to using R to work with phylogenies.</p>
<p>Packages are pre-arranged sets of data, functions, and other R programming components.
Often, when we want to do something in R like perform a statistical test or make a figure, someone has done this before.
If they have published their code online in a package, you can borrow the functions they have written in order to do your own work.</p>
<p><em>See the <a href="https://cran.r-project.org/web/views/">CRAN task view website</a>, with specific focus <a href="https://cran.r-project.org/web/views/Phylogenetics.html">on the Phylogenetics task view</a>.</em></p>
<p>Any time you need to use a specialized set of functions, you can probably find a relevant library on CRAN or through another software source like GitHub.
We are going to dive into a specific library that you’ll use throughout the rest of this course called <code>picante</code>.</p>
</div>
<div id="the-picante-library" class="section level2">
<h2>The <code>picante</code> library</h2>
<p><code>picante</code> provides functions for phylogenetic and community analysis.
You’ll be using phylogenetic analysis later in the semester for your upcoming assignments.</p>
<p>The first step to using a package is installation.
We’ll install the <code>picante</code> package from an online source - for R, most of the time you will be installing packages from CRAN, the Comprehensive R Archive Network.</p>
<p>We can install packages in R using the <code>install.packages()</code> command.
After the package has been installed, we load it into our R session using the <code>library()</code> command.</p>
<pre class="r"><code># Dependencies are other packages that can be borrowed from
install.packages(&quot;picante&quot;, dependencies = TRUE)

library(picante)</code></pre>
<p><em>Note</em>: You only have to install the package once; every time you start a new R session, however, you have to load the package with <code>library()</code>.</p>
<p>Just like with functions, we can use the <code>help()</code> command to find out more information about our newly loaded library in the <code>Help</code> tab on the right-hand panel.</p>
<p>Let’s take a closer look at picante and the functions it adds to our library:</p>
<pre class="r"><code>help(package=picante)</code></pre>
<p>This shows us individual help pages for each function that <code>picante</code> provides - you can see there are a lot of available functions that come with <code>picante</code>.</p>
<p><img src="/home/mairin/Pictures/picantehelp.png" /></p>
<p>Inside of the help panel, we can also look at something called a vignette - a friendly introductory tutorial that is designed to give you an easy entry point to using the package.</p>
<p><img src="/home/mairin/Pictures/picantevignette.png" /></p>
<p>We’ll be working together through some of the materials presented in <code>picante</code>’s vignette, in fact.</p>
<p>Finally, some packages come with data sets just like the <code>iris</code> data set we looked at last week.
<code>picante</code> comes with a data set called <code>phylocom</code> - it includes phylogenetic, community, and trait data.</p>
<p>You can load this with</p>
<pre class="r"><code>data(&quot;phylocom&quot;)</code></pre>
<p>and inspect the contents with</p>
<pre class="r"><code>help(phylocom)
# or
summary(phylocom)</code></pre>
<pre><code>##        Length Class      Mode   
## phylo    5    phylo      list   
## sample 150    -none-     numeric
## traits   4    data.frame list</code></pre>
<p>Notice that <code>phylocom</code> has three named components that we can access one-at-a-time using the <code>$</code> notation: phylo, sample, and traits.
These are the phylogenetic tree, a data frame of which species are found where, and the traits that those species have.</p>
<p>For example:</p>
<pre class="r"><code># The phylogenetic tree:
phylocom$phylo

# The community data:
phylocom$sample

# And finally, trait data:
phylocom$traits</code></pre>
<p>Let’s talk about what these data types are, because you’ll be using them in your assignments throughout the rest of this course.</p>
<div id="data-types-in-picante-the-phylo-class" class="section level3">
<h3>Data types in <code>picante</code>: the <code>phylo</code> class</h3>
<p>In <code>picante</code> and other phylogenetic libraries in R, there is a special class of data called the <code>phylo</code> class.
This data type represents phylogenetic trees in a way that the computer and R can understand and manipulate.</p>
<p>Ignoring the <code>phylocom</code> data set that is pre-built into <code>picante</code>, we’re going to start with a simple example phylogeny that has four species of owl.
Let’s create a <code>phylo</code> class object using the <code>read.tree()</code> command that was added to our library when we installed <code>picante</code>.</p>
<p>We’re not going to build the tree from scratch, rather we’re going to read in a pre-saved phylogeny from the <code>owls.tre</code> Newick file, indicated by the <code>.tre</code> file type. This line will work <em>only if</em> your <code>owls.tre</code> file is located inside of the folder where R is running. You can check this with the <code>dir()</code> command.</p>
<pre class="r"><code>owl.tree &lt;- read.tree(&quot;owls.tre&quot;)</code></pre>
<p>If you don’t know where your file is located and want to find it using a pop-up file selection window, you can also read in the .tre file with:</p>
<pre class="r"><code>owl.tree &lt;- read.tree(file.choose())</code></pre>
<p>Take a look at the tree:</p>
<pre class="r"><code>owl.tree</code></pre>
<pre><code>## 
## Phylogenetic tree with 4 tips and 3 internal nodes.
## 
## Tip labels:
## [1] &quot;Strix_aluco&quot;   &quot;Asio_otus&quot;     &quot;Athene_noctua&quot; &quot;Tyto_alba&quot;    
## 
## Rooted; includes branch lengths.</code></pre>
<p>R tells us there are four tips and three internal nodes (or, four species and three internal branching points).</p>
<p>We can take a closer look using the <code>str[ucture]</code> command like this:</p>
<pre class="r"><code>str(owl.tree)</code></pre>
<pre><code>## List of 4
##  $ edge       : int [1:6, 1:2] 5 6 7 7 6 5 6 7 1 2 ...
##  $ edge.length: num [1:6] 6.3 3.1 4.2 4.2 7.3 13.5
##  $ Nnode      : int 3
##  $ tip.label  : chr [1:4] &quot;Strix_aluco&quot; &quot;Asio_otus&quot; &quot;Athene_noctua&quot; &quot;Tyto_alba&quot;
##  - attr(*, &quot;class&quot;)= chr &quot;phylo&quot;
##  - attr(*, &quot;order&quot;)= chr &quot;cladewise&quot;</code></pre>
<div id="components-of-a-phylo-object" class="section level4">
<h4>Components of a <code>phylo</code> object</h4>
<p>There are four named components in our phylogenetic tree:</p>
<ol style="list-style-type: decimal">
<li><code>edge</code>: a 2-dimensional matrix where each row is an edge of the tree</li>
</ol>
<pre class="r"><code>owl.tree$edge</code></pre>
<pre><code>##      [,1] [,2]
## [1,]    5    6
## [2,]    6    7
## [3,]    7    1
## [4,]    7    2
## [5,]    6    3
## [6,]    5    4</code></pre>
<pre class="r"><code># relationships between ancestors and tips, current species</code></pre>
<p>This tells us that there are six edges in total in our phylogenetic tree.
The first edge, [ 5 6 ] is the branch that runs from our root, node #5, to node #6, the splitting point.</p>
<ol start="2" style="list-style-type: decimal">
<li><code>Nnode</code>: 3, the number of internal nodes (does not include the tips)</li>
<li><code>tip.label</code>: a vector of names that are used on the tips of the tree</li>
</ol>
<pre class="r"><code>owl.tree$tip.label</code></pre>
<pre><code>## [1] &quot;Strix_aluco&quot;   &quot;Asio_otus&quot;     &quot;Athene_noctua&quot; &quot;Tyto_alba&quot;</code></pre>
<ol start="4" style="list-style-type: decimal">
<li><code>edge.length</code>: a vector of numbers that correspond to the lengths of the edges in <code>$edge</code></li>
</ol>
<pre class="r"><code>owl.tree$edge.length</code></pre>
<pre><code>## [1]  6.3  3.1  4.2  4.2  7.3 13.5</code></pre>
<p>These are the components that go into a <code>phylo</code> object.</p>
</div>
<div id="what-the-phylo-object-looks-like-underneath" class="section level4">
<h4>What the <code>phylo</code> object looks like underneath</h4>
<p>Let’s take a peek at the original file we read into R as a phylo object.
We can do this by opening the text file directly in R.</p>
<pre><code>owls(((Strix_aluco:4.2,Asio_otus:4.2):3.1,Athene_noctua:7.3):6.3,Tyto_alba:13.5);</code></pre>
<p><code>owls</code> = the name of the tree</p>
<p>The colon <code>:</code> separates the tip labels from the edge lengths, parentheses show us which species should be connected by that branch length.</p>
<p>Notice that the tips are shown from bottom to top - we can compare all of this to the results we saw when we called <code>$edge</code> and <code>$edge.lengths</code> in the <code>phylo</code> object.</p>
<p>Everything we see in the phylogenetic tree comes from a relatively simple file.</p>
</div>
<div id="plotting-a-phylogenetic-tree" class="section level4">
<h4>Plotting a phylogenetic tree</h4>
<p>Plotting a <code>phylo</code> object is straightforward:</p>
<pre class="r"><code>plot(owl.tree)</code></pre>
<p><img src="/teaching/conservation/Phylo/12.12.2018.Biol416.RPhyloTutorial_post_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>We can add modifications like adding tip labels</p>
<pre class="r"><code>plot(owl.tree)
# Adding a horizontal scale bar:
add.scale.bar()
# Adding a text label to show the units for the scale bar
text(1,1.1,&quot;MY&quot;)
# Adding labels to the intermediate nodes
nodelabels()</code></pre>
<p><img src="/teaching/conservation/Phylo/12.12.2018.Biol416.RPhyloTutorial_post_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
</div>
<div id="modifying-phylo-objects" class="section level4">
<h4>Modifying <code>phylo</code> objects</h4>
<div id="changing-tip-names" class="section level5">
<h5>Changing tip names</h5>
<p>There are two ways to modify the tip names in the phylogenetic tree: you can directly edit the Newick text document or you can modify the names in R itself.</p>
<p>Be careful about how you write these names - R, like many programming languages, cannot handle spaces in names and will have issues if you provide spaces.</p>
<p>When changing the Newick file directly, let’s change the name of <em>Strix aluco</em> to Owl One, and save as a new file, <code>owls2.tre</code>:</p>
<pre><code>owls(((Owl_one:4.2,Asio_otus:4.2):3.1,Athene_noctua:7.3):6.3,Tyto_alba:13.5);</code></pre>
<pre class="r"><code>owl.tree.2 &lt;- read.tree(&quot;owls2.tre&quot;)

plot(owl.tree.2)</code></pre>
<p><img src="/teaching/conservation/Phylo/12.12.2018.Biol416.RPhyloTutorial_post_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>We can also change the name using the <code>$tip.label</code> component of the phylogenetic object.</p>
<pre class="r"><code># Save a pristine copy of owl.tree first, in case we make mistakes later on
owl.tree.3 &lt;- owl.tree
owl.tree.3$tip.label</code></pre>
<pre><code>## [1] &quot;Strix_aluco&quot;   &quot;Asio_otus&quot;     &quot;Athene_noctua&quot; &quot;Tyto_alba&quot;</code></pre>
<pre class="r"><code>owl.tree.3$tip.label[1] &lt;- &quot;Owl_one&quot;

plot(owl.tree.3)</code></pre>
<p><img src="/teaching/conservation/Phylo/12.12.2018.Biol416.RPhyloTutorial_post_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
</div>
<div id="change-edge-lengths" class="section level5">
<h5>Change edge lengths</h5>
<p>Similar to how we changed the tip labels for the phylogenetic tree, we can also change the edge lengths of the branches in the tree.
Let’s try this by changing the edge lengths equal to 1 million years.</p>
<p>To do this in the Newick file, change all numbers to <code>1</code>, save as a new file <code>owls.branch1.tre</code>, and load into R:</p>
<pre><code>owls(((Strix_aluco:1,Asio_otus:1):1,Athene_noctua:1):1,Tyto_alba:1);</code></pre>
<pre class="r"><code>owl.tree.4 &lt;- read.tree(&quot;owls_branch1.tre&quot;)

plot(owl.tree.4)</code></pre>
<p><img src="/teaching/conservation/Phylo/12.12.2018.Biol416.RPhyloTutorial_post_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>Notice that the edge length leading to <em>Tyto alba</em> is now much shorter than it used to be - this is because the phylogenetic tree’s branches are all the same size.
So if we know that Owl one and <em>Asio otus</em> are 1MY apart, and work our way back to the root node, the phylogenetic tree believes that <em>Tyto alba</em>’s lineage disappeared only one million years after the root node.</p>
<p>Of course, we can also make this change in R using <code>$edge.length</code></p>
<pre class="r"><code>owl.tree.4 &lt;- owl.tree

# How many edges are there to replace with 1&#39;s?
n.edges &lt;- nrow(owl.tree.4$edge)
owl.tree.4$edge.length &lt;- rep(1, n.edges)
# Another way to do this:
owl.tree.4$edge.length[1:6] &lt;- 1

plot(owl.tree.4)</code></pre>
<p><img src="/teaching/conservation/Phylo/12.12.2018.Biol416.RPhyloTutorial_post_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="data-types-in-picante-community-objects" class="section level3">
<h3>Data types in <code>picante</code>: community objects</h3>
<p>Often when we work with phylogenetic data, we’re interested in comparing the phylogenetic history of the species observed in a species community.
The <code>picante</code> package also uses community data, records of observations of a species at different sites.</p>
<p>Community data is represented as a 2D object (data-frame/matrix) where sites/samples are placed in the rows and taxa in the columns.</p>
<p>So let’s make a new data-frame for our owls at three imaginary sites: <code>SiteA</code>, <code>B</code>, and <code>C</code>:</p>
<table>
<thead>
<tr class="header">
<th></th>
<th align="center">Strix_aluco</th>
<th align="center">Asio_otus</th>
<th align="center">Athene_noctua</th>
<th align="center">Tyto_alba</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>SiteA</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td>SiteB</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">1</td>
</tr>
<tr class="odd">
<td>SiteC</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">1</td>
</tr>
</tbody>
</table>
<p>To make this data frame in R, we could either read in a .csv file of community data or, because we’re using a simple example, we can also make a new data frame from scratch and tell R what to put in each column:</p>
<pre class="r"><code>owl.comm &lt;- data.frame(Strix_aluco = c(0,0,1),
                       Asio_otus = c(1,0,0),
                       Athene_noctua = c(1,1,1),
                       Tyto_alba = c(0,1,1)
)

##### Just create this in Excel then export to .csv and read it in

rownames(owl.comm) &lt;- c(&quot;SiteA&quot;,&quot;SiteB&quot;,&quot;SiteC&quot;)
owl.comm</code></pre>
<pre><code>##       Strix_aluco Asio_otus Athene_noctua Tyto_alba
## SiteA           0         1             1         0
## SiteB           0         0             1         1
## SiteC           1         0             1         1</code></pre>
<p>Now we have a community data set, showing which species were present at each site.</p>
<p>What <code>picante</code> can do now is match the column names to the tip labels in our phylogenetic tree. <strong>Note that the column names MUST MATCH the tip labels in the <code>phylo</code> object!</strong></p>
<p>While column names are used to match the species in each community to that species’ position in the phylogeny, row names can be used to give informative site names.</p>
</div>
<div id="putting-it-all-together---calculating-phylogenetic-diversity-pd" class="section level3">
<h3>Putting it all together - calculating phylogenetic diversity, PD</h3>
<p>Now we have two data objects - a phylogenetic tree for four owl species and a community data-frame showing which species were in sites A, B, and C.</p>
<p><img src="/teaching/conservation/Phylo/12.12.2018.Biol416.RPhyloTutorial_post_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<p>The next thing we are going to do is calculated phylogenetic diversity, also called PD.
Phylogenetic diversity is a measure of how much phylogenetic time is captured by an observed species assemblage.
It captures the total <strong>edge length</strong> of a phylogenetic tree that is represented by a community.</p>
<p>Of the three sites shown above, which do you think will have the greatest phylogenetic diversity?</p>
<div id="the-pd-calculation" class="section level4">
<h4>The PD calculation</h4>
<p>Basically, when we calculate phylogenetic diversity, we are calculating how much evolutionary time is represented in that community, or the phylogenetic distinctiveness of its members.
If all species are very closely related to one another, PD is low; conversely, if there is a lot of evolutionary differentiation between species present in a community, PD is high.</p>
<p>We’re now going to calculate the phylogenetic diversity of our owl community in two ways: first by hand, then using a pre-built function from <code>picante</code>.</p>
<p>Steps:</p>
<ol style="list-style-type: decimal">
<li>Prune the phylogenetic tree for each community so that it only spans the observed species</li>
<li>Decide whether to include the root node or create a new root node for the community</li>
<li>Sum together the branch lengths to calculate PD</li>
</ol>
</div>
<div id="calculating-pd-by-hand" class="section level4">
<h4>Calculating PD by hand</h4>
<pre class="r"><code>##### Subset to Site A first, then create list of taxa that are present and absent, drop the tips of the absent species

siteA.absent &lt;- colnames(owl.comm)[
  which(owl.comm[&quot;SiteA&quot;,]==0) # Take the time to explain this step!!!!
  ]
owl.tree.siteA &lt;- drop.tip(owl.tree, siteA.absent)
siteA.pd &lt;- sum(owl.tree.siteA$edge.length)

plot(owl.tree.siteA)
edgelabels()</code></pre>
<p><img src="/teaching/conservation/Phylo/12.12.2018.Biol416.RPhyloTutorial_post_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<pre class="r"><code>### Now repeat for sites B and C
siteB.absent &lt;- colnames(owl.comm)[
  which(owl.comm[&quot;SiteB&quot;,]==0) # Take the time to explain this step!!!!
  ]
owl.tree.siteB &lt;- drop.tip(owl.tree, siteB.absent)
owl.tree.siteB</code></pre>
<pre><code>## 
## Phylogenetic tree with 2 tips and 1 internal nodes.
## 
## Tip labels:
## [1] &quot;Athene_noctua&quot; &quot;Tyto_alba&quot;    
## 
## Rooted; includes branch lengths.</code></pre>
<pre class="r"><code>siteB.pd &lt;- sum(owl.tree.siteB$edge.length)

siteC.absent &lt;- colnames(owl.comm)[
  which(owl.comm[&quot;SiteC&quot;,]==0) # Take the time to explain this step!!!!
  ]
owl.tree.siteC &lt;- drop.tip(owl.tree, siteC.absent)
siteC.pd &lt;- sum(owl.tree.siteC$edge.length)

paste0(&quot;A:&quot;, siteA.pd, &quot;    B:&quot;, siteB.pd, &quot;    C:&quot;, siteC.pd)</code></pre>
<pre><code>## [1] &quot;A:14.6    B:27.1    C:34.4&quot;</code></pre>
<p>Site A, where the only species present are “clumped” phylogenetically, has the lowest phylogenetic diversity while Site C has the highest.</p>
</div>
<div id="calculating-pd-with-the-built-in-picante-function" class="section level4">
<h4>Calculating PD with the built-in <code>picante</code> function</h4>
<p>Even though calculating PD by hand is relatively easy, it can be tedious going site-by-site.
Luckily, we can use <code>picante</code>’s built-in <code>pd()</code> function to calculate PD for each site automatically.</p>
<pre class="r"><code>##### Mention what the include.root means - on the board 
all.sites.pd &lt;- pd(samp = owl.comm, tree = owl.tree, include.root = FALSE)
all.sites.pd</code></pre>
<pre><code>##         PD SR
## SiteA 14.6  2
## SiteB 27.1  2
## SiteC 34.4  3</code></pre>
<p>Using the built-in function, we get the same answers as we did through hand calculations.</p>
<p>Notice that the function gives us a data frame as output - we can now save this data.frame or use the values within for more calculations.</p>
</div>
</div>
</div>
</div>


<footer class=" footline" >
	
</footer>


        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/teaching/conservation/phylo/12.12.2018.biol416.rphylotutorial/" title="BIOL 416 R Tutorial 2 - Phylogenies in R"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/teaching/conservation/phylo/biol416_tutorial3_phylogeneticsr/" title="BIOL 416 R Tutorial 2 - Phylogenies in R" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1558662433"></script>
    <script src="/js/perfect-scrollbar.min.js?1558662433"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1558662433"></script>
    <script src="/js/jquery.sticky.js?1558662433"></script>
    <script src="/js/featherlight.min.js?1558662433"></script>
    <script src="/js/html5shiv-printshiv.min.js?1558662433"></script>
    <script src="/js/highlight.pack.js?1558662433"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1558662433"></script>
    <script src="/js/learn.js?1558662433"></script>
    <script src="/js/hugo-learn.js?1558662433"></script>

    <link href="/mermaid/mermaid.css?1558662433" type="text/css" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1558662433"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>

